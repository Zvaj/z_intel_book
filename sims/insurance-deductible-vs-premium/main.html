<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insurance Deductible vs Premium Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: system-ui, -apple-system, sans-serif; background: #f8f9fa; padding: 20px; color: #333; }
        .container { max-width: 850px; margin: 0 auto; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); padding: 24px; }
        h1 { font-size: 22px; margin-bottom: 6px; color: #1a5f7a; text-align: center; }
        .subtitle { text-align: center; color: #666; font-size: 13px; margin-bottom: 24px; }
        .plans-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 24px; }
        @media(max-width:600px){ .plans-grid { grid-template-columns: 1fr; } }
        .plan-card { border-radius: 10px; padding: 18px; border: 2px solid #e9ecef; }
        .plan-a { border-color: #1a5f7a; }
        .plan-b { border-color: #fd7e14; }
        .plan-title { font-size: 15px; font-weight: 700; margin-bottom: 14px; }
        .plan-a .plan-title { color: #1a5f7a; }
        .plan-b .plan-title { color: #fd7e14; }
        .field { margin-bottom: 12px; }
        .field label { font-size: 12px; font-weight: 600; color: #666; display: block; margin-bottom: 4px; }
        .field input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; }
        .field .hint { font-size: 11px; color: #999; margin-top: 3px; }
        .scenario-section { margin-bottom: 24px; }
        .scenario-section h3 { font-size: 14px; font-weight: 700; color: #555; margin-bottom: 10px; }
        .input-row { display: flex; gap: 10px; align-items: center; margin-bottom: 16px; }
        input[type="range"] { flex: 1; height: 6px; border-radius: 3px; outline: none; -webkit-appearance: none; background: #e0e0e0; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%; background: #1a5f7a; cursor: pointer; }
        input[type="number"].range-num { width: 90px; padding: 6px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px; text-align: center; }
        .results-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px; }
        .result-card { border-radius: 10px; padding: 16px; text-align: center; }
        .result-a { background: #e8f4f8; border: 2px solid #1a5f7a; }
        .result-b { background: #fff3e6; border: 2px solid #fd7e14; }
        .result-card .total { font-size: 28px; font-weight: 800; }
        .result-a .total { color: #1a5f7a; }
        .result-b .total { color: #fd7e14; }
        .result-card .breakdown { font-size: 12px; color: #666; margin-top: 6px; }
        .winner-box { text-align: center; padding: 12px; border-radius: 8px; font-size: 14px; font-weight: 600; margin-bottom: 20px; }
        .winner-a { background: #d1ecf1; color: #0c5460; }
        .winner-b { background: #ffeeba; color: #856404; }
        .winner-tie { background: #e9ecef; color: #555; }
    </style>
</head>
<body>
<div class="container">
    <h1>Insurance Deductible vs Premium Calculator</h1>
    <p class="subtitle">Compare two health insurance plans side by side. Find the breakeven point where each plan costs the same.</p>

    <div class="plans-grid">
        <div class="plan-card plan-a">
            <div class="plan-title">Plan A (Low Deductible)</div>
            <div class="field">
                <label>Monthly Premium ($)</label>
                <input type="number" id="premiumA" value="350" oninput="recalc()">
                <div class="hint">What you pay each month whether or not you use it</div>
            </div>
            <div class="field">
                <label>Annual Deductible ($)</label>
                <input type="number" id="deductibleA" value="500" oninput="recalc()">
            </div>
            <div class="field">
                <label>Out-of-Pocket Maximum ($)</label>
                <input type="number" id="oopA" value="3000" oninput="recalc()">
            </div>
            <div class="field">
                <label>Coinsurance after deductible (%)</label>
                <input type="number" id="coinA" value="20" oninput="recalc()">
                <div class="hint">% of costs you pay after meeting deductible</div>
            </div>
        </div>
        <div class="plan-card plan-b">
            <div class="plan-title">Plan B (High Deductible)</div>
            <div class="field">
                <label>Monthly Premium ($)</label>
                <input type="number" id="premiumB" value="180" oninput="recalc()">
            </div>
            <div class="field">
                <label>Annual Deductible ($)</label>
                <input type="number" id="deductibleB" value="2000" oninput="recalc()">
            </div>
            <div class="field">
                <label>Out-of-Pocket Maximum ($)</label>
                <input type="number" id="oopB" value="6000" oninput="recalc()">
            </div>
            <div class="field">
                <label>Coinsurance after deductible (%)</label>
                <input type="number" id="coinB" value="20" oninput="recalc()">
            </div>
        </div>
    </div>

    <div class="scenario-section">
        <h3>Your Expected Annual Medical Expenses</h3>
        <div class="input-row">
            <input type="range" id="medCosts" min="0" max="20000" step="100" value="1000" oninput="syncMed(this.value)">
            <input type="number" class="range-num" id="medCostsNum" value="1000" min="0" max="20000" oninput="syncMed(this.value)">
        </div>
    </div>

    <div class="results-grid">
        <div class="result-card result-a">
            <div style="font-size:14px;font-weight:700;color:#1a5f7a;margin-bottom:6px;">Plan A Total Cost</div>
            <div class="total" id="totalA">$0</div>
            <div class="breakdown" id="breakdownA"></div>
        </div>
        <div class="result-card result-b">
            <div style="font-size:14px;font-weight:700;color:#fd7e14;margin-bottom:6px;">Plan B Total Cost</div>
            <div class="total" id="totalB">$0</div>
            <div class="breakdown" id="breakdownB"></div>
        </div>
    </div>

    <div class="winner-box" id="winnerBox"></div>

    <canvas id="chart"></canvas>
</div>
<script>
let chart;
function syncMed(v) {
    document.getElementById('medCosts').value = v;
    document.getElementById('medCostsNum').value = v;
    recalc();
}
function fmt(n) { return '$' + Math.round(n).toLocaleString(); }
function g(id) { return parseFloat(document.getElementById(id).value) || 0; }

function calcTotal(premium, deductible, oop, coin, medCosts) {
    const annualPremium = premium * 12;
    let outOfPocket = 0;
    if (medCosts <= deductible) {
        outOfPocket = medCosts;
    } else {
        outOfPocket = deductible + (medCosts - deductible) * (coin / 100);
    }
    outOfPocket = Math.min(outOfPocket, oop);
    return { total: annualPremium + outOfPocket, premium: annualPremium, oop: outOfPocket };
}

function recalc() {
    const medCosts = g('medCosts');
    const rA = calcTotal(g('premiumA'), g('deductibleA'), g('oopA'), g('coinA'), medCosts);
    const rB = calcTotal(g('premiumB'), g('deductibleB'), g('oopB'), g('coinB'), medCosts);

    document.getElementById('totalA').textContent = fmt(rA.total);
    document.getElementById('breakdownA').innerHTML = `Premium: ${fmt(rA.premium)}<br>Out-of-pocket: ${fmt(rA.oop)}`;
    document.getElementById('totalB').textContent = fmt(rB.total);
    document.getElementById('breakdownB').innerHTML = `Premium: ${fmt(rB.premium)}<br>Out-of-pocket: ${fmt(rB.oop)}`;

    const wb = document.getElementById('winnerBox');
    const diff = Math.abs(rA.total - rB.total);
    if (Math.abs(rA.total - rB.total) < 50) {
        wb.className = 'winner-box winner-tie';
        wb.textContent = `Plans cost roughly the same at this expense level ($${Math.round(medCosts).toLocaleString()} in medical bills).`;
    } else if (rA.total < rB.total) {
        wb.className = 'winner-box winner-a';
        wb.textContent = `Plan A saves you ${fmt(diff)}/year at $${medCosts.toLocaleString()} in medical costs. Lower deductible wins when you use the insurance more.`;
    } else {
        wb.className = 'winner-box winner-b';
        wb.textContent = `Plan B saves you ${fmt(diff)}/year at $${medCosts.toLocaleString()} in medical costs. High-deductible plans win in healthy years.`;
    }

    // Build chart across expense range
    const expenses = [];
    const dataA = [];
    const dataB = [];
    for (let e = 0; e <= 20000; e += 500) {
        const a = calcTotal(g('premiumA'), g('deductibleA'), g('oopA'), g('coinA'), e);
        const b = calcTotal(g('premiumB'), g('deductibleB'), g('oopB'), g('coinB'), e);
        expenses.push('$' + e.toLocaleString());
        dataA.push(Math.round(a.total));
        dataB.push(Math.round(b.total));
    }

    if (!chart) {
        chart = new Chart(document.getElementById('chart'), {
            type: 'line',
            data: {
                labels: expenses,
                datasets: [
                    { label: 'Plan A (Low Deductible)', data: dataA, borderColor: '#1a5f7a', backgroundColor: '#1a5f7a20', tension: 0.2, borderWidth: 2 },
                    { label: 'Plan B (High Deductible)', data: dataB, borderColor: '#fd7e14', backgroundColor: '#fd7e1420', tension: 0.2, borderWidth: 2 }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { position: 'bottom' },
                    title: { display: true, text: 'Total Annual Cost by Medical Expenses' }
                },
                scales: { y: { ticks: { callback: v => '$' + v.toLocaleString() } } }
            }
        });
    } else {
        chart.data.datasets[0].data = dataA;
        chart.data.datasets[1].data = dataB;
        chart.update();
    }
}

recalc();
</script>
</body>
</html>
