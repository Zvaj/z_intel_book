<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tax Bracket Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: system-ui, -apple-system, sans-serif; background: #f8f9fa; padding: 20px; color: #333; }
        .container { max-width: 850px; margin: 0 auto; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); padding: 24px; }
        h1 { font-size: 22px; margin-bottom: 6px; color: #1a5f7a; text-align: center; }
        .subtitle { text-align: center; color: #666; font-size: 13px; margin-bottom: 24px; }
        .controls { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 24px; }
        .control-group { display: flex; flex-direction: column; gap: 8px; }
        label { font-size: 13px; font-weight: 600; color: #555; }
        .input-row { display: flex; gap: 10px; align-items: center; }
        input[type="range"] { flex: 1; height: 6px; border-radius: 3px; outline: none; -webkit-appearance: none; background: #e0e0e0; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%; background: #1a5f7a; cursor: pointer; }
        input[type="number"] { width: 100px; padding: 6px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px; text-align: center; }
        select { padding: 7px 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px; background: white; width: 100%; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; margin-bottom: 24px; }
        .stat { background: #f0f7fa; border-radius: 10px; padding: 14px; text-align: center; }
        .stat .val { font-size: 22px; font-weight: 800; color: #1a5f7a; }
        .stat .lbl { font-size: 11px; color: #666; margin-top: 3px; }
        .bracket-table { width: 100%; border-collapse: collapse; font-size: 13px; margin-bottom: 24px; }
        .bracket-table th { background: #1a5f7a; color: white; padding: 8px 12px; text-align: left; }
        .bracket-table td { padding: 8px 12px; border-bottom: 1px solid #e9ecef; }
        .bracket-table tr:last-child td { border-bottom: none; }
        .bracket-table .active-row { background: #d4edda; font-weight: 700; }
        .bracket-table .active-row td:first-child::after { content: " ← you are here"; font-size: 11px; color: #28a745; }
        .myth-box { background: #f8d7da; border-left: 4px solid #dc3545; padding: 12px 16px; border-radius: 6px; font-size: 13px; margin-top: 16px; }
        .myth-box strong { color: #721c24; }
    </style>
</head>
<body>
<div class="container">
    <h1>Tax Bracket Calculator</h1>
    <p class="subtitle">See exactly how much you owe in each bracket — and bust the "higher bracket" myth.</p>

    <div class="controls">
        <div class="control-group">
            <label>Gross Annual Income ($)</label>
            <div class="input-row">
                <input type="range" id="income" min="0" max="500000" step="1000" value="55000" oninput="sync('income',this.value)">
                <input type="number" id="incomeNum" value="55000" oninput="sync('income',this.value)">
            </div>
        </div>
        <div class="control-group">
            <label>Filing Status</label>
            <select id="filing" onchange="recalc()">
                <option value="single">Single</option>
                <option value="mfj">Married Filing Jointly</option>
                <option value="hoh">Head of Household</option>
            </select>
        </div>
        <div class="control-group">
            <label>Pre-tax deductions (401k, HSA, etc.) ($)</label>
            <div class="input-row">
                <input type="range" id="deductions" min="0" max="50000" step="500" value="0" oninput="sync('deductions',this.value)">
                <input type="number" id="deductionsNum" value="0" oninput="sync('deductions',this.value)">
            </div>
        </div>
    </div>

    <div class="stats">
        <div class="stat">
            <div class="val" id="taxableIncome">$0</div>
            <div class="lbl">Taxable Income</div>
        </div>
        <div class="stat">
            <div class="val" id="federalTax">$0</div>
            <div class="lbl">Federal Income Tax</div>
        </div>
        <div class="stat">
            <div class="val" id="effectiveRate">0%</div>
            <div class="lbl">Effective Tax Rate</div>
        </div>
        <div class="stat">
            <div class="val" id="marginalRate">0%</div>
            <div class="lbl">Marginal (Top) Rate</div>
        </div>
        <div class="stat">
            <div class="val" id="ficaTax">$0</div>
            <div class="lbl">FICA (SS + Medicare)</div>
        </div>
        <div class="stat">
            <div class="val" id="takeHome">$0</div>
            <div class="lbl">Est. Annual Take-Home</div>
        </div>
    </div>

    <canvas id="chart" style="margin-bottom:20px"></canvas>

    <table class="bracket-table">
        <thead><tr><th>Tax Rate</th><th>Bracket (Single 2025)</th><th>Income in This Bracket</th><th>Tax Owed</th></tr></thead>
        <tbody id="bracketBody"></tbody>
    </table>

    <div class="myth-box">
        <strong>The Bracket Myth — Busted:</strong> "A raise put me in a higher bracket so I earn less." This is <em>never true</em>. Only the dollars above the threshold are taxed at the higher rate. A raise always increases your take-home pay. Period.
    </div>
</div>
<script>
// 2025 tax brackets (single)
const brackets2025 = {
    single: [
        { rate: 0.10, min: 0,      max: 11925  },
        { rate: 0.12, min: 11925,  max: 48475  },
        { rate: 0.22, min: 48475,  max: 103350 },
        { rate: 0.24, min: 103350, max: 197300 },
        { rate: 0.32, min: 197300, max: 250525 },
        { rate: 0.35, min: 250525, max: 626350 },
        { rate: 0.37, min: 626350, max: Infinity }
    ],
    mfj: [
        { rate: 0.10, min: 0,      max: 23850  },
        { rate: 0.12, min: 23850,  max: 96950  },
        { rate: 0.22, min: 96950,  max: 206700 },
        { rate: 0.24, min: 206700, max: 394600 },
        { rate: 0.32, min: 394600, max: 501050 },
        { rate: 0.35, min: 501050, max: 751600 },
        { rate: 0.37, min: 751600, max: Infinity }
    ],
    hoh: [
        { rate: 0.10, min: 0,      max: 17000  },
        { rate: 0.12, min: 17000,  max: 64850  },
        { rate: 0.22, min: 64850,  max: 103350 },
        { rate: 0.24, min: 103350, max: 197300 },
        { rate: 0.32, min: 197300, max: 250500 },
        { rate: 0.35, min: 250500, max: 626350 },
        { rate: 0.37, min: 626350, max: Infinity }
    ]
};

const standardDeduction = { single: 15000, mfj: 30000, hoh: 22500 }; // 2025

let chart;

function sync(id, val) {
    document.getElementById(id).value = val;
    document.getElementById(id + 'Num').value = val;
    recalc();
}
function fmt(n) { return '$' + Math.round(n).toLocaleString(); }

function recalc() {
    const grossIncome = parseFloat(document.getElementById('income').value) || 0;
    const filing = document.getElementById('filing').value;
    const pretaxDeductions = parseFloat(document.getElementById('deductions').value) || 0;

    const agi = Math.max(0, grossIncome - pretaxDeductions);
    const stdDed = standardDeduction[filing];
    const taxableIncome = Math.max(0, agi - stdDed);

    const brackets = brackets2025[filing];
    let totalTax = 0;
    let marginalRate = 0;
    const bracketTaxes = [];
    const bracketLabels = [];
    const bracketAmounts = [];

    brackets.forEach(b => {
        if (taxableIncome <= b.min) {
            bracketTaxes.push(0);
        } else {
            const inBracket = Math.min(taxableIncome, b.max) - b.min;
            const tax = inBracket * b.rate;
            bracketTaxes.push(tax);
            totalTax += tax;
            if (inBracket > 0) marginalRate = b.rate;
        }
        bracketLabels.push((b.rate * 100).toFixed(0) + '%');
        bracketAmounts.push(bracketTaxes[bracketTaxes.length-1]);
    });

    const fica = Math.min(grossIncome, 176100) * 0.062 + grossIncome * 0.0145;
    const effective = taxableIncome > 0 ? totalTax / grossIncome : 0;
    const takeHome = grossIncome - totalTax - fica;

    document.getElementById('taxableIncome').textContent = fmt(taxableIncome);
    document.getElementById('federalTax').textContent = fmt(totalTax);
    document.getElementById('effectiveRate').textContent = (effective * 100).toFixed(1) + '%';
    document.getElementById('marginalRate').textContent = (marginalRate * 100).toFixed(0) + '%';
    document.getElementById('ficaTax').textContent = fmt(fica);
    document.getElementById('takeHome').textContent = fmt(takeHome);

    // Bracket table
    const tbody = document.getElementById('bracketBody');
    tbody.innerHTML = brackets.map((b, i) => {
        if (b.max === Infinity && taxableIncome <= b.min) return '';
        const inBracket = taxableIncome <= b.min ? 0 : Math.min(taxableIncome, b.max === Infinity ? taxableIncome : b.max) - b.min;
        const isActive = inBracket > 0 && (i === brackets.length-1 || taxableIncome < brackets[i+1].min);
        const row = `<tr class="${isActive ? 'active-row' : ''}">
            <td>${(b.rate*100).toFixed(0)}%</td>
            <td>${fmt(b.min)} – ${b.max === Infinity ? '∞' : fmt(b.max)}</td>
            <td>${fmt(inBracket)}</td>
            <td>${fmt(inBracket * b.rate)}</td>
        </tr>`;
        return row;
    }).join('');

    // Chart: stacked bar showing income allocation
    const nonTaxable = pretaxDeductions + stdDed;
    const chartData = brackets.map((b, i) => bracketTaxes[i] > 0 ? bracketTaxes[i] : null);
    const nonTaxableAmt = Math.min(grossIncome, nonTaxable);

    if (!chart) {
        chart = new Chart(document.getElementById('chart'), {
            type: 'bar',
            data: {
                labels: ['Your Income Breakdown'],
                datasets: [
                    { label: 'Non-taxable (deductions)', data: [nonTaxableAmt], backgroundColor: '#6c757d80', borderColor: '#6c757d', borderWidth: 1, borderRadius: 4 },
                    { label: '10% bracket', data: [bracketTaxes[0]], backgroundColor: '#28a74580', borderColor: '#28a745', borderWidth: 1, borderRadius: 0 },
                    { label: '12% bracket', data: [bracketTaxes[1]], backgroundColor: '#17a2b880', borderColor: '#17a2b8', borderWidth: 1 },
                    { label: '22% bracket', data: [bracketTaxes[2]], backgroundColor: '#ffc10780', borderColor: '#ffc107', borderWidth: 1 },
                    { label: '24% bracket', data: [bracketTaxes[3]], backgroundColor: '#fd7e1480', borderColor: '#fd7e14', borderWidth: 1 },
                    { label: '32%+ bracket', data: [bracketTaxes[4]+bracketTaxes[5]+bracketTaxes[6]], backgroundColor: '#dc354580', borderColor: '#dc3545', borderWidth: 1 }
                ]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                plugins: { legend: { position: 'bottom', labels: { font: { size: 11 } } } },
                scales: {
                    x: { stacked: true, ticks: { callback: v => '$' + (v/1000).toFixed(0) + 'k' } },
                    y: { stacked: true }
                }
            }
        });
    } else {
        chart.data.datasets[0].data = [nonTaxableAmt];
        chart.data.datasets[1].data = [bracketTaxes[0]];
        chart.data.datasets[2].data = [bracketTaxes[1]];
        chart.data.datasets[3].data = [bracketTaxes[2]];
        chart.data.datasets[4].data = [bracketTaxes[3]];
        chart.data.datasets[5].data = [bracketTaxes[4]+bracketTaxes[5]+bracketTaxes[6]];
        chart.update();
    }
}

recalc();
</script>
</body>
</html>
